<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <%- include('layouts/header'); -%>
  <title>MovieHunter</title>
</head>
<body>
<!-- Nav Bar Starts here -->
<%- include('layouts/nav_bar'); -%>
<!-- SubNav Bar Starts here -->
<%- include('layouts/sub_nav'); -%>

  <div id="main">
    <div id="content">
      <div class="box">
        <div class="head">
          <h2>TOP RATED</h2>
        </div>
        <br>
        <% 
        var sortedMovies = movies.sort((a, b) => b.imdb_score - a.imdb_score);
        for(var i = 0; i < sortedMovies.length && i < 6; i++) { 
        %>
            <div class="movie">
                <div class="movie-image"> 
                    <a href="/movie/detail/<%= sortedMovies[i]._id %>">
                        <img src=<%= sortedMovies[i].Images %> alt="Submit" width="155" height="220">
                    </a>
                </div>
        
                <div class="rating">
                    <h3>IMDB Score <span><%= sortedMovies[i].imdb_score %></span></h3>
                </div>
            </div>
        <% } %>
    </div>  
    <div class="cl">&nbsp;</div>
        
  

    <!-- <div class="box">
      <div class="head">
        <h2>New Movies</h2>
      </div>
      <br>
      <% for(var i = 0; i < movies.length; i++) { %>
        <% if (movies[i].title_year >= 2016) { %> 
      <div class="movie">
        <div class="movie-image"> 
          <a href="/movie/detail/<%= movies[i]._id %>">
            <img src=<%= movies[i].Images %> alt="Submit" width="155" height="220">
        </a>
        
           
        </div>
        <div class="rating">
          <h3>IMDB Score <span> <%= movies[i].imdb_score %> </span></h3>
        </div>
      </div>
      <% }%>
      <% }%> 
    </div>
  <div class="cl">&nbsp;</div> -->
  <div class="box">
    <div class="head">
        <h2>New Movies</h2>
    </div>
    <br>

    <% 
    var newestMovies = movies.filter(movie => movie.title_year >= 2016);
    var sortedNewestMovies = newestMovies.sort((a, b) => b.imdb_score - a.imdb_score);
    for(var i = 0; i < sortedNewestMovies.length && i < 6; i++) { 
    %>
        <div class="movie">
            <div class="movie-image"> 
                <a href="/movie/detail/<%= sortedNewestMovies[i]._id %>">
                    <img src="<%= sortedNewestMovies[i].Images %>" alt="Submit" width="155" height="220">
                </a>
            </div>
            <div class="rating">
                <h3>IMDB Score <span><%= sortedNewestMovies[i].imdb_score %></span></h3>
            </div>
        </div>
    <% } %>
</div>

<div class="cl">&nbsp;</div>

  
  <div class="box">
    <div class="head">
      <h2>Big Budget Movies</h2>
    </div>
    <br>
    <% for(var i = 0; i < movies.length; i++) { %>
      <% if (movies[i].gross >= 330249062) { %> 
    <div class="movie">
      <div class="movie-image"> 
        <a href="/movie/detail/<%= movies[i]._id %>">
          <img src=<%= movies[i].Images %> alt="Submit" width="155" height="220">
      </a>
      
         
      </div>
      <div class="rating">
        <h3>IMDB Score <span> <%= movies[i].imdb_score %> </span></h3>
      </div>
    </div>
    <% }%>
    <% }%> 
  </div>
</div>
<div class="cl">&nbsp;</div>
<!-- Footer Starts here -->
<%- include('layouts/footer'); -%>

<!-- END PAGE SOURCE -->
</body>
</html>